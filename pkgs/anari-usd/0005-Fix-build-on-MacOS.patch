From dacc1e96b5c9175e6e8e10379f016c4d6eed2f97 Mon Sep 17 00:00:00 2001
From: Thomas Arcila <134677+tarcila@users.noreply.github.com>
Date: Sun, 1 Mar 2026 18:33:54 -0500
Subject: [PATCH 5/5] Fix build on MacOS

---
 UsdBridge/CMakeLists.txt                     | 5 ++++-
 UsdBridge/Connection/UsdBridgeConnection.cpp | 2 +-
 2 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/UsdBridge/CMakeLists.txt b/UsdBridge/CMakeLists.txt
index 10adedc..32f24a8 100644
--- a/UsdBridge/CMakeLists.txt
+++ b/UsdBridge/CMakeLists.txt
@@ -250,7 +250,10 @@ if (WIN32)
   target_link_directories(UsdBridge PUBLIC "${USD_PYTHON_LINK_DIRS}" "${USD_LIB_DIR}")
 
 else()
-  set(PLATFORM_LIBS pthread dl stdc++fs)
+  set(PLATFORM_LIBS pthread dl)
+  if(CMAKE_CXX_COMPILER_ID MATCHES "GNU")
+    list(APPEND PLATFORM_LIBS  stdc++fs)
+  endif()
   target_link_libraries(UsdBridge PRIVATE general ${PLATFORM_LIBS} )
   if(NOT ${USD_DEVICE_USE_CXX11_ABI})
     target_compile_definitions(UsdBridge PRIVATE _GLIBCXX_USE_CXX11_ABI=0)
diff --git a/UsdBridge/Connection/UsdBridgeConnection.cpp b/UsdBridge/Connection/UsdBridgeConnection.cpp
index 89a69d8..6ebb923 100644
--- a/UsdBridge/Connection/UsdBridgeConnection.cpp
+++ b/UsdBridge/Connection/UsdBridgeConnection.cpp
@@ -21,7 +21,7 @@ namespace fs = std::filesystem;
 namespace fs = std::experimental::filesystem;
 #endif
 #else
-#if (__GNUC__ < 8 || __cplusplus < 201703L)
+#if (defined(__clang__) && __clang_major__ < 5) || (!defined(__clang__) && __GNUC__ < 8) || __cplusplus < 201703L
 #include <experimental/filesystem>
 namespace fs = std::experimental::filesystem;
 #else
-- 
2.51.2

